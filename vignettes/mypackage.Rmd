---
title: "Project 3: PACKAGE_NAME mypackage"
author: "Kobe Sarausad"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{mypackage}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

To install `mypackage` onto R, run the following line:

```{r eval = FALSE}
# install.packages("devtools")
devtools::install_github("kobesar/mypackage")
```

To load the package run the following line:

```{r eval = FALSE}
library(mypackage)
library(ggplot2)
```

# my_t.test tutorial

`my_t.test` applies the t-test given a vector of values, a character indicating the type of test, and a numeric indicating the testing mean. The alternative can be either "two.sided", "less", or "greater". 

We will use the `lifeExp` column from the `my_gapminder` data to apply a t-test.

First we will perform a t-test in which our alternative hypothesis is that the mean is not 60.

```{r}
my_gapminder <- mypackage::my_gapminder

x <- my_gapminder$lifeExp # vector of values
alternative <- "two.sided" # indicates we are testing 
mu <- 60 # our mean

mypackage::my_t.test(x, alternative, mu)
```

From the returned list, we are able to observe that our p-value is much smaller compared to $\alpha\$, so we are able to reject the null hypothesis that 

Then, we perform our t-test on the alternative hypothesis that the mean is less than 60.

```{r}
x <- my_gapminder$lifeExp # vector of values
alternative <- "less" # indicates we are testing 
mu <- 60 # our mean

mypackage::my_t.test(x, alternative, mu)
```

Finally, we perform our t-test on the alternative hypothesis that the mean is more than 60.

```{r}
x <- my_gapminder$lifeExp # vector of values
alternative <- "greater" # indicates we are testing 
mu <- 60 # our mean

mypackage::my_t.test(x, alternative, mu)
```
# my_lm tutorial

`my_lm` applies linear regression given a formula and a dataframe.

Here, we will apply regression to the `lifeExp` variable, from the my_gapminder data, using `gdpPercap` and `continent` as our predictors.

```{r}
lm <- mypackage::my_lm(lifeExp ~ gdpPercap + continent, my_gapminder)
lm
```

The gdpPercap coefficient represents the change in lifeExp per unit increase/decrease in gdpPercap. 

Comparison of predicted vs fitted values.

```{r}
x <- model.matrix(lifeExp ~ gdpPercap + continent, my_gapminder)
est <- lm[, 1]

fitted <- x %*% est

fit_act <- data.frame(cbind(fitted, my_gapminder$lifeExp))

colnames(fit_act) <- c("fit", "actual")

ggplot2::ggplot(fit_act) +
  ggplot2::geom_point(ggplot2::aes(fit, actual)) +
  ggplot2::xlim(c(0, 110)) +
  ggplot2::ylim(c(0, 110))

```

# my_knn_cv tutorial

`my_knn_cv` applies k-nearest neighbors cross validation given an output class, covariate dataframe, number of folds, and the number of neighbors.

Make sure to first omit any `NA` rows!

```{r}
my_penguins <- na.omit(mypackage::my_penguins)

error_df <- data.frame(matrix(ncol = 3))

colnames(error_df) <- c("k_nn", "cv_error", "train_error")

for (k_nn in 1:10) {
  cv_error <- mypackage::my_knn_cv(my_penguins[, 3:6], 
                        my_penguins$species,
                        k_nn, 
                        5)$cv_error

  train_error <- mean(class::knn(my_penguins[, 3:6], 
                          my_penguins[, 3:6], 
                          my_penguins$species, 
                          k_nn) != my_penguins$species)
  
  error_df <- rbind(error_df, c(k_nn, cv_error, train_error))
}
```

# my_rf_cv tutorial

```{r}
error_df <- data.frame(matrix(ncol = 2))

colnames(error_df) <- c("k", "cv_error")

for (k in c(2, 5, 10)) {
  for (i in 1:30) {
    cv_error <- mypackage::my_rf_cv(k)$cv_error
    error_df <- rbind(error_df, c(k, cv_error))
  }
}


```
